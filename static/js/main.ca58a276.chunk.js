(this["webpackJsonpreact-chat-app"]=this["webpackJsonpreact-chat-app"]||[]).push([[0],{10:function(e,t,n){e.exports=n(28)},15:function(e,t,n){},16:function(e,t,n){},27:function(e,t,n){},28:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(8),s=n.n(r),c=(n(15),n(16),n(9)),i=n(1),m=n(2),l=n(4),u=n(3),d=n(5),h=function(e){var t=e.senderId,n=e.text;return o.a.createElement("div",{className:"message"},o.a.createElement("div",{className:"message-username"},t),o.a.createElement("div",{className:"message-text"},n.parts[0].payload.content))},g=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).messageListRef=o.a.createRef(),n}return Object(d.a)(t,e),Object(m.a)(t,[{key:"getSnapshotBeforeUpdate",value:function(e,t){var n=this.messageListRef.current;return this.shouldScrollToBottom=n.scrollTop+n.clientHeight+100>=n.scrollHeight,this.shouldScrollToBottom}},{key:"componentDidUpdate",value:function(e,t,n){if(n){var a=this.messageListRef.current;a.scrollTop=a.scrollHeight}}},{key:"render",value:function(){var e=this.props,t=e.messages,n=e.currentRoomId,a=e.messageFullArea,r=t.map((function(e,t){return o.a.createElement(h,{senderId:e.senderId,text:e,key:e.id})})),s=a?"full-area":"";return n?o.a.createElement("div",{className:"message-list  ".concat(s),ref:this.messageListRef},r):o.a.createElement("div",{className:"message-list",ref:this.messageListRef},o.a.createElement("div",{className:"start-message"},"Click a room to start chatting"))}}]),t}(a.Component),f=function(e){var t=e.roomName,n=e.roomId,a=e.subscribeToRoom,r=e.currentRoomId===n?"active":"";return o.a.createElement("li",{className:"room ".concat(r)},o.a.createElement("button",{onClick:function(){return a(n,t)}},"# ",t))},p=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props,t=e.joinedRooms,n=e.joinableRooms,a=e.subscribeToRoom,r=e.currentRoomId,s=t.sort((function(e,t){return e.name.toUpperCase()<t.name.toUpperCase()?-1:1})).map((function(e){return o.a.createElement(f,{roomName:e.name,roomId:e.id,key:e.id,subscribeToRoom:a,currentRoomId:r})})),c=n.sort((function(e,t){return e.name.toUpperCase()<t.name.toUpperCase()?-1:1})).map((function(e){return o.a.createElement(f,{roomName:e.name,roomId:e.id,key:e.id,subscribeToRoom:a,currentRoomId:r})}));return o.a.createElement("div",{className:"rooms-list"},o.a.createElement("h3",null,"Your Rooms"),0===s.length?o.a.createElement("p",null,"Click to join rooms"):o.a.createElement("ul",null,s),o.a.createElement("h3",null,"Rooms to join"),0===c.length?o.a.createElement("p",null,"No new rooms yet"):o.a.createElement("ul",null,c))}}]),t}(a.Component),b=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={roomName:""},n.handleChange=function(e){n.setState({roomName:e.target.value})},n.handleSubmit=function(e){e.preventDefault(),n.props.creatRoom(n.state.roomName),n.setState({roomName:""})},n}return Object(d.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"new-room-form"},o.a.createElement("form",{onSubmit:this.handleSubmit},o.a.createElement("input",{value:this.state.roomName,type:"text",placeholder:"Create a room",onChange:this.handleChange}),o.a.createElement("button",null,"+")))}}]),t}(a.Component),v=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={message:""},n.handleChange=function(e){n.setState({message:e.target.value})},n.handleSubmit=function(e){var t=n.props.sendMessage;e.preventDefault(),t(n.state.message),n.setState({message:""})},n}return Object(d.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props,t=e.currentRoomId,n=e.messageFullArea?"fixed":"";return o.a.createElement("div",{className:"send-message-form  ".concat(n)},o.a.createElement("form",{onSubmit:this.handleSubmit},o.a.createElement("input",{disabled:t,type:"text",value:this.state.message,onChange:this.handleChange,placeholder:"Type message and hit enter"})))}}]),t}(a.Component),R=n(6),E=function(e){var t="online"===e.presence?"online":"offline";return o.a.createElement("div",{className:"indicator ".concat(t)})},j=function(e){var t=e.presence,n=e.name,a=e.currentUser,r=a.presenceStore[a.id]===t?"(you)":"";return console.log(a.id,a.presenceStore[a.id]),o.a.createElement("li",{className:"contact"},o.a.createElement(E,{presence:t}),o.a.createElement("img",{className:"avatar",src:"https://ui-avatars.com/api/?name=".concat(n,"&size=30&rounded=true"),alt:"avatar"}),"".concat(n," ").concat(r))},k=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props,t=e.roomUsers,n=e.currentUser,a=t.map((function(e){return o.a.createElement(j,{name:e.name,key:e.id,presence:e.presenceStore["".concat(e.id)],currentUser:n})}));return o.a.createElement("div",{className:"contacts-list"},o.a.createElement("h3",null,"Your Contacts"),o.a.createElement("ul",null,a))}}]),t}(a.Component),y=(n(27),function(e){return o.a.createElement("button",{"aria-label":"menu",id:"menu",className:"header_menu",onClick:e.handleHamburgerClick},o.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M2 6h20v3H2zm0 5h20v3H2zm0 5h20v3H2z"})))}),C=function(e){var t=e.currentRoomName,n=e.currentRoomId,a=e.handleHamburgerClick,r=e.messageFullArea?"fixed":"";return n?o.a.createElement("header",{className:"room-header ".concat(r)},o.a.createElement(y,{handleHamburgerClick:a}),o.a.createElement("h1",null,t)):null},I=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={messages:[],joinableRooms:[],joinedRooms:[],currentRoomId:null,roomUsers:[],currentRoomName:null,messageFullArea:!1},n.handleHamburgerClick=function(){n.setState((function(e){return{messageFullArea:!e.messageFullArea}}))},n.sendMessageToChatkit=function(e){n.currentUser.sendSimpleMessage({roomId:n.state.currentRoomId,text:e}).catch((function(e){console.log("Error: ".concat(e))})),n.currentUser.isTypingIn({roomId:n.state.currentRoomId}).then((function(){console.log("Success!",n.currentUser.name)})).catch((function(e){console.log("Error sending typing indicator: ".concat(e))}))},n.subscribeToRoom=function(e,t){n.setState({currentRoomId:e,messages:[],currentRoomName:t}),n.currentUser.subscribeToRoomMultipart({roomId:e,hooks:{onMessage:function(e){n.setState({messages:[].concat(Object(c.a)(n.state.messages),[e])}),console.log(e)},onPresenceChanged:function(e,t){console.log("User ".concat(t," ").concat(t.id," is ").concat(e.current))},onUserStartedTyping:function(e){console.log("User ".concat(e.name," started typing"))},onUserStoppedTyping:function(e){console.log("User ".concat(e.name," stopped typing"))}},messageLimit:20}).then((function(e){n.setState({currentRoomId:e.id,roomUsers:e.users}),n.getRooms()})).catch((function(e){return console.log("error on subscribing to room: ",e)}))},n.getRooms=function(){n.currentUser.getJoinableRooms().then((function(e){n.setState({joinableRooms:e,joinedRooms:n.currentUser.rooms})})).catch((function(e){console.log("Error getting joinable rooms: ".concat(e))}))},n.fetchRoomMessages=function(e){n.currentUser.fetchMultipartMessages({roomId:e,direction:"older"}).then((function(e){n.setState({messages:e})})).catch((function(e){console.log("Error fetching messages: ".concat(e))}))},n.creatRoom=function(e){n.currentUser.createRoom({name:e}).then((function(e){n.subscribeToRoom(e.id),console.log("Created room called ".concat(e.name))})).catch((function(e){console.log("Error creating room ".concat(e))}))},n}return Object(d.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=this;console.log("componentDidMount"),new R.ChatManager({instanceLocator:"v1:us1:700177bd-bd75-420e-9fe7-c47980afae0c",userId:"salma",tokenProvider:new R.TokenProvider({url:"https://us1.pusherplatform.io/services/chatkit_token_provider/v1/700177bd-bd75-420e-9fe7-c47980afae0c/token"})}).connect().then((function(t){e.currentUser=t,e.getRooms(),console.log("Successful connection",t.rooms)})).catch((function(e){console.log("Error on connection",e)}))}},{key:"render",value:function(){return o.a.createElement("div",{className:"app"},o.a.createElement(C,{currentRoomName:this.state.currentRoomName,currentRoomId:this.state.currentRoomId,handleHamburgerClick:this.handleHamburgerClick,messageFullArea:this.state.messageFullArea}),o.a.createElement(g,{messages:this.state.messages,startMessage:this.state.startMessage,currentRoomId:this.state.currentRoomId,messageFullArea:this.state.messageFullArea}),o.a.createElement(p,{joinedRooms:this.state.joinedRooms,joinableRooms:this.state.joinableRooms,subscribeToRoom:this.subscribeToRoom,currentRoomId:this.state.currentRoomId}),o.a.createElement(k,{roomUsers:this.state.roomUsers,currentUser:this.currentUser}),o.a.createElement(b,{creatRoom:this.creatRoom}),o.a.createElement(v,{sendMessage:this.sendMessageToChatkit,currentRoomId:!this.state.currentRoomId,messageFullArea:this.state.messageFullArea}))}}]),t}(a.Component);var N=function(){return o.a.createElement(I,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(o.a.createElement(N,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[10,1,2]]]);
//# sourceMappingURL=main.ca58a276.chunk.js.map